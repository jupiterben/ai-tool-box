# Prompt迭代拓展生成工具规范

## Constitution Check

本规范遵循项目宪法原则：

- ✅ Minimal Dependencies: 依赖最小化
- ✅ Modern Standards: 现代标准优先
- ✅ Code Quality: 代码质量保证
- ✅ Performance First: 性能优先

## Scope

本规范涵盖一个交互式Prompt生成工具，允许用户从初始需求开始，通过AI辅助的迭代拓展过程，逐步完善并最终生成详细的提示词。

**包含范围：**

- 初始需求输入界面
- AI辅助的拓展方向生成
- 用户选择拓展方向的交互流程
- 迭代拓展过程（5-10次迭代）
- 最终详细提示词的生成和展示
- 提示词的保存和导出功能

**不包含范围：**

- AI模型的具体实现细节（使用现有AI集成）
- 提示词的执行或运行
- 提示词库或模板管理
- 多用户协作功能
- 提示词版本控制

## User Stories

### User Story 1: 输入初始需求

**优先级：P1**

作为用户，我希望能够输入一个简单的初始需求或想法，以便开始生成提示词的过程。

**验收标准：**

- 提供清晰的文本输入区域用于输入初始需求
- 输入框支持多行文本输入
- 有明确的提示说明用户应该输入什么内容
- 输入验证确保至少包含基本内容（非空）

### User Story 2: AI生成拓展方向

**优先级：P1**

作为用户，我希望系统能够基于当前的需求状态，使用AI生成多个可能的拓展方向，以便我选择最合适的拓展路径。

**验收标准：**

- 每次迭代时，AI能够生成3-5个不同的拓展方向
- 每个拓展方向都有清晰的描述说明
- 拓展方向与当前需求状态相关且有意义
- 生成过程有明确的加载状态提示
- 生成失败时有友好的错误提示

### User Story 3: 选择拓展方向

**优先级：P1**

作为用户，我希望能够从AI生成的多个拓展方向中选择一个，以便继续深入拓展该方向。

**验收标准：**

- 所有拓展方向以清晰的列表或卡片形式展示
- 每个方向都可以被单独选择
- 选择操作有明确的视觉反馈
- 选择后能够立即进入下一轮拓展
- 支持取消选择或重新选择

### User Story 4: 迭代拓展过程

**优先级：P1**

作为用户，我希望能够进行5-10次迭代拓展，每次基于前一次的选择继续深入，以便逐步完善提示词。

**验收标准：**

- 系统记录并显示当前的迭代次数（1-10）
- 每次迭代都基于前一次的选择生成新的拓展方向
- 能够查看整个拓展路径的历史记录
- 在达到最大迭代次数（10次）时给出提示
- 支持在达到最小迭代次数（5次）后随时结束拓展

### User Story 5: 生成最终提示词

**优先级：P1**

作为用户，我希望在完成迭代拓展后，系统能够生成一个详细、完整的提示词，以便我使用或保存。

**验收标准：**

- 最终提示词包含所有迭代过程中选择的方向内容
- 提示词结构清晰、逻辑完整
- 提示词以可读的格式展示（支持格式化显示）
- 提示词可以完整复制
- 生成过程有明确的进度提示

### User Story 6: 保存和导出提示词

**优先级：P2**

作为用户，我希望能够保存生成的提示词，以便后续使用或分享。

**验收标准：**

- 提供保存功能，将提示词保存到本地
- 支持导出为文本文件（.txt或.md格式）
- 保存的提示词包含生成时间等元信息
- 保存操作有明确的成功/失败反馈

### User Story 7: 查看拓展历史

**优先级：P2**

作为用户，我希望能够查看整个拓展过程的历史记录，以便了解提示词的生成路径。

**验收标准：**

- 显示每次迭代的拓展方向和选择
- 历史记录以时间线或树状结构展示
- 可以展开/折叠查看详细信息
- 支持在历史记录中导航

## Functional Requirements

### FR1: 初始需求输入

- **FR1.1**: 提供多行文本输入框，支持至少500字符的输入
- **FR1.2**: 输入框有占位符提示，说明用户应该输入的内容格式
- **FR1.3**: 输入验证：确保输入内容非空且至少包含10个字符
- **FR1.4**: 提供"开始拓展"按钮，点击后进入拓展流程
- **FR1.5**: 支持清空输入内容

### FR2: AI拓展方向生成

- **FR2.1**: 调用AI接口，基于当前需求状态生成3-5个拓展方向
- **FR2.2**: 每个拓展方向包含：标题（简短描述）和说明（详细描述）
- **FR2.3**: 生成过程显示加载状态（加载动画或进度提示）
- **FR2.4**: 生成失败时显示错误信息，提供重试功能
- **FR2.5**: 生成的拓展方向与当前上下文相关，避免重复或无关内容

### FR3: 拓展方向选择

- **FR3.1**: 以列表或卡片形式展示所有拓展方向
- **FR3.2**: 每个方向可单独选择，选择状态有明确的视觉反馈
- **FR3.3**: 选择后显示"确认选择"按钮，点击后进入下一轮迭代
- **FR3.4**: 支持取消当前选择，重新选择其他方向
- **FR3.5**: 选择操作有明确的交互反馈（动画或状态变化）

### FR4: 迭代流程管理

- **FR4.1**: 显示当前迭代次数（1-10）
- **FR4.2**: 记录每次迭代的选择内容，形成拓展路径
- **FR4.3**: 在达到5次迭代后，显示"完成拓展"选项，允许用户提前结束
- **FR4.4**: 在达到10次迭代后，自动进入最终提示词生成阶段
- **FR4.5**: 支持查看当前拓展路径的摘要信息
- **FR4.6**: 支持重置流程，重新开始（需确认操作）

### FR5: 最终提示词生成

- **FR5.1**: 整合所有迭代过程中选择的方向内容
- **FR5.2**: 使用AI生成结构化的详细提示词
- **FR5.3**: 提示词包含：背景说明、详细需求、具体要求、输出格式等部分
- **FR5.4**: 生成过程显示进度提示
- **FR5.5**: 生成的提示词以格式化文本展示，支持语法高亮（如适用）
- **FR5.6**: 提供"重新生成"功能，允许用户重新生成提示词

### FR6: 提示词展示和操作

- **FR6.1**: 最终提示词在独立的展示区域显示
- **FR6.2**: 支持一键复制整个提示词内容
- **FR6.3**: 支持文本选择和部分复制
- **FR6.4**: 提供格式化显示选项（纯文本、Markdown等）
- **FR6.5**: 显示提示词的基本统计信息（字数、段落数等）

### FR7: 保存和导出

- **FR7.1**: 提供"保存"按钮，将提示词保存到本地存储
- **FR7.2**: 支持导出为文本文件（.txt格式）
- **FR7.3**: 支持导出为Markdown文件（.md格式）
- **FR7.4**: 保存的文件包含：提示词内容、生成时间、迭代次数等元信息
- **FR7.5**: 导出操作有明确的成功/失败反馈

### FR8: 历史记录查看

- **FR8.1**: 显示完整的迭代历史，包括每次的拓展方向和选择
- **FR8.2**: 历史记录以时间线或树状结构展示
- **FR8.3**: 支持展开/折叠查看每次迭代的详细信息
- **FR8.4**: 支持在历史记录中快速定位特定迭代
- **FR8.5**: 历史记录与最终提示词关联，可以查看生成路径

## Success Criteria

### 功能完整性

- 用户能够从初始需求开始，完成完整的5-10次迭代拓展流程
- AI生成的拓展方向与上下文相关，用户能够从中选择合适的方向
- 最终生成的提示词包含所有迭代内容，结构完整、逻辑清晰
- 所有核心功能（输入、拓展、选择、生成、保存）正常工作

### 用户体验

- 用户完成一次完整流程（从输入到生成提示词）的时间不超过10分钟
- 每次AI生成拓展方向的时间不超过15秒
- 最终提示词生成时间不超过30秒
- 界面操作直观，用户无需阅读文档即可完成基本操作
- 错误提示清晰，用户能够理解问题并采取相应行动

### 提示词质量

- 生成的提示词字数在200-2000字之间（根据迭代次数和内容复杂度）
- 提示词结构清晰，包含必要的组成部分（背景、需求、要求、输出格式等）
- 用户对生成的提示词满意度达到4.0/5.0以上（通过用户反馈收集）
- 生成的提示词可以直接使用，无需大幅修改

### 系统性能

- AI接口调用成功率≥95%
- 界面响应时间（非AI操作）<100毫秒
- 支持至少1000字符的初始需求输入
- 系统能够稳定处理10次迭代的完整流程

### 数据持久化

- 提示词保存成功率达到100%
- 导出的文件格式正确，内容完整
- 保存的元信息准确无误

## Technical Constraints

### AI集成约束

- 必须使用现有的AI集成接口，不引入新的AI服务依赖
- AI调用需要处理超时和错误情况
- AI响应需要合理的重试机制（最多3次）
- 需要控制AI调用的频率，避免过度请求

### 性能约束

- 单次AI调用响应时间不应超过30秒
- 界面在AI调用期间应保持响应，不阻塞用户操作
- 本地存储的提示词数据不应超过10MB
- 历史记录数据应合理管理，避免内存占用过大

### 数据约束

- 初始需求输入限制在2000字符以内
- 每次迭代的拓展方向描述限制在500字符以内
- 最终提示词长度限制在5000字符以内
- 历史记录最多保存最近50次完整流程

### 浏览器兼容性

- 支持 Electron 内置 Chromium 版本
- 文件导出功能需要兼容 Electron 环境
- 本地存储功能需要兼容 Electron 存储机制

## Assumptions

1. **AI服务可用性**: 假设现有的AI集成服务稳定可用，能够提供拓展方向生成和最终提示词生成功能。如果现有服务不支持，需要在规划阶段确定替代方案。

2. **迭代次数**: 假设用户通常进行5-8次迭代即可生成满意的提示词，10次为上限。具体迭代次数由用户决定（在5-10次范围内）。

3. **拓展方向数量**: 假设每次生成3-5个拓展方向能够为用户提供足够的选择，同时不会造成选择困难。

4. **提示词格式**: 假设生成的提示词为文本格式，支持Markdown语法。具体格式将在规划阶段根据AI能力确定。

5. **存储方式**: 假设使用Electron的本地存储机制保存提示词，支持文件系统访问用于导出功能。

6. **用户流程**: 假设用户会按顺序完成流程（输入→拓展→选择→...→生成），不需要支持复杂的跳转或回退操作（基本的查看历史除外）。

## Dependencies

### 内部依赖

- 现有的AI集成接口（需要确认是否支持本功能所需的AI调用）
- 现有的UI组件系统（MainLayout、输入组件等）
- 现有的类型定义系统
- Electron的文件系统访问能力

### 外部依赖（待评估）

- AI服务接口（需要确认现有集成是否满足需求）
- 文件导出功能（可能需要文件系统API）

### 前置条件

- 确认AI服务能够支持拓展方向生成和提示词生成功能
- 确定AI调用的具体接口和参数格式
- 确定提示词的生成策略和格式要求

## Testing

### 功能测试

- 初始需求输入验证测试
- AI拓展方向生成测试（正常情况、失败情况、超时情况）
- 用户选择流程测试
- 迭代流程完整性测试（5次、10次迭代）
- 最终提示词生成测试
- 保存和导出功能测试

### 用户体验测试

- 完整流程端到端测试
- 界面响应性测试
- 错误处理测试（网络错误、AI服务错误等）
- 边界情况测试（极短输入、极长输入、快速连续操作等）

### 性能测试

- AI调用响应时间测试
- 界面渲染性能测试
- 大量历史记录的内存占用测试
- 文件导出性能测试

### 兼容性测试

- Electron环境测试
- 不同窗口尺寸下的界面显示测试
- 文件系统访问权限测试

## Out of Scope

以下内容不在本规范范围内：

1. **AI模型训练或优化**: 不涉及AI模型本身的改进，仅使用现有AI服务
2. **提示词执行**: 不包含提示词的运行、测试或执行功能
3. **提示词库管理**: 不包含提示词模板库、分类管理等功能
4. **多用户功能**: 不包含用户账户、协作、分享等功能
5. **版本控制**: 不包含提示词的版本管理、历史版本对比等功能
6. **高级编辑**: 不包含提示词的在线编辑、格式化工具等高级编辑功能
7. **提示词分析**: 不包含提示词质量分析、优化建议等功能
